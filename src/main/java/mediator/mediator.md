#设计模式8：中介者模式 Mediator Pattern

#### 类型：
 行为类模式

#### 定义
Define an object that the encapsulates how a set of objects interact. Mediator promotes loose coupling by keeping objects form referring to each other explicitly, and it lets you vary their interaction independently.
用一个中介者对象封装一些列的对象交互，中介者是各对象不需要显示地相互作用，从而使其耦合松散，而且可以独立的改变她们之间的交互。

#### 结构
类图
(img)

- Mediator 抽象中介者
	抽象中介者角色定义同意各借口，用于各同事角色之间的通信。
- Concrete Mediator
	具体中介者角色通过协调各同事角色实现协作行为，因此他依赖于个个同事角色。从抽象中介者继承而来，实现抽象中介者中定义的事件方法。从一个同事类接收消息，然后通过消息影响其他同时类
- Colleague 同事角色
	每个同事角色都知道中介者角色，而且于其他的同事角色通信的时候，一定要通过中介者角色协作。每个同事类的行为分为两种：一种是同事本身的行为，比如改变对象本身的状态，处理自己的行为，无需和其他同事类交互。这种行为叫做自发行为（Self-Method）,于其他的同事类或中介者没有任何依赖；第二种是必须依赖中介者才能完成的行为，叫做依赖方法（Dep-Method）。


#### 为什么要使用该模式
      一般来说，同事类之间的关系是比较复杂的，多个同事类之间互相关联时，他们之间的关系会呈现为复杂的网状结构，这是一种过度耦合的架构，即不利于类的复用，也不稳定。例如在下图中，有六个同事类对象，假如对象1发生变化，那么将会有4个对象受到影响。如果对象2发生变化，那么将会有5个对象受到影响。也就是说，同事类之间直接关联的设计是不好的。
(img)
如果引入中介者模式，那么同事类之间的关系将变为星型结构，从图中可以看到，任何一个类的变动，只会影响的类本身，以及中介者，这样就减小了系统的耦合。一个好的设计，必定不会把所有的对象关系处理逻辑封装在本类中，而是使用一个专门的类来管理那些不属于自己的行为。
(img)

#### 中介者模式的优点
	- 适当地使用中介者模式可以避免同事类之间的过度耦合，使得各同事类之间可以相对独立地使用。
	 - 使用中介者模式可以将对象间一对多的关联转变为一对一的关联，使对象间的关系易于理解和维护。
	- 使用中介者模式可以将对象的行为和协作进行抽象，能够比较灵活的处理对象间的相互作用。

#### 中介者模式的缺点
中介者模式的缺点就是中介者会膨胀的很多，而且逻辑复杂。原本N个对象直接的相互依赖关系转换为中介者类和同事类之间的依赖关系，同事类越多，中介者的逻辑和结构就越复杂。


#### 适用场景

在面向对象编程中，一个类必然会与其他的类发生依赖关系，完全独立的类是没有意义的。一个类同时依赖多个类的情况也相当普遍，既然存在这样的情况，说明，一对多的依赖关系有它的合理性，适当的使用中介者模式可以使原本凌乱的对象关系清晰，但是如果滥用，则可能会带来反的效果。一般来说，只有对于那种同事类之间是网状结构的关系，才会考虑使用中介者模式。可以将网状结构变为星状结构，使同事类之间的关系变的清晰一些。
       中介者模式是一种比较常用的模式，也是一种比较容易被滥用的模式。对于大多数的情况，同事类之间的关系不会复杂到混乱不堪的网状结构，因此，大多数情况下，将对象间的依赖关系封装的同事类内部就可以的，没有必要非引入中介者模式。滥用中介者模式，只会让事情变的更复杂。


#### 注意
中介者模式中 很少用到接口或者抽象类。这与依赖倒置原则是冲突的。同事类不是兄弟类，这些类之间是协作关系，完成不同的任务，处理不同的业务。所以不能再抽象类中定制统一的接口。

#### 参考文献
[http://blog.csdn.net/zhengzhb/article/details/7430098]

模式代码例子：github
